% While writing, don't stop for errors
\nonstopmode

%%% This is based on the Frontiers template.
\documentclass{frontiersSCNS}

\usepackage{url,hyperref,lineno,microtype}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage[onehalfspacing]{setspace}
\linenumbers

% Trick to define a language alias and permit language = {en} in the .bib file.
% From: http://tex.stackexchange.com/questions/199254/babel-define-language-synonym
\usepackage{letltxmacro}
\LetLtxMacro{\ORIGselectlanguage}{\selectlanguage}
\makeatletter
\DeclareRobustCommand{\selectlanguage}[1]{%
  \@ifundefined{alias@\string#1}
    {\ORIGselectlanguage{#1}}
    {\begingroup\edef\x{\endgroup
       \noexpand\ORIGselectlanguage{\@nameuse{alias@#1}}}\x}%
}
\newcommand{\definelanguagealias}[2]{%
  \@namedef{alias@#1}{#2}%
}
\makeatother
\definelanguagealias{en}{english}
\definelanguagealias{eng}{english}
% End language alias trick


\def\keyFont{\fontsize{8}{11}\helveticabold }
\def\firstAuthorLast{James {et~al.}}
\def\Authors{Sebastian James\,$^{1,2,*}$, Alexander Blenkinsop\,$^{1,2}$, \\
  Alexander Cope\,$^3$, Sean Anderson\,$^{2,4}$, Dimitrios Stanev\,$^5$, \\
  Chris Papapavlou\,$^5$, Konstantinos Moustakas\,$^5$, Kevin Gurney\,$^{1,2}$}
% Affiliations should be keyed to the author's name with superscript
% numbers and be listed as follows: Laboratory, Institute, Department,
% Organization, City, State abbreviation (USA, Canada, Australia), and
% Country (without detailed address information such as city zip codes
% or street names).
%
% If one of the authors has a change of address, list the new address
% below the correspondence details using a superscript symbol and use
% the same symbol to indicate the author in the author list.
\def\Address{\\
$^{1}$Adaptive Behaviour Research Group, Department of Psychology,
  The University of Sheffield, Sheffield, UK \\
$^{2}$Insigneo Institute for in-silico Medicine,
  The University of Sheffield, Sheffield, UK \\
$^{3}$Department of Computer Science,
  The University of Sheffield, Sheffield, UK \\
$^{4}$Department of Automatic Control Systems Engineering,
  The University of Sheffield, Sheffield, UK \\
$^{5}$Department of Computer Science,
  The University of Patras, Patras, Greece \\
}
% The Corresponding Author should be marked with an asterisk. Provide
% the exact contact address (this time including street name and city
% zip code) and email of the corresponding author
\def\corrAuthor{Kevin Gurney}
\def\corrAddress{Department of Psychology, The University of Sheffield,
  Western Bank, Sheffield, S10 2TP, UK}
\def\corrEmail{k.gurney@sheffield.ac.uk}


\begin{document}

% A place for aliases:
\input{sebcommands.tex}

\onecolumn
\firstpage{1}

\title[Integrated brain and biomechanics]{
  Integrating brain and biomechanical models - a paradigm shift
  towards neuro-muscular control
}

\author[\firstAuthorLast ]{\Authors}
\address{}
\correspondance{}
\extraAuth{} % If more than 1 corr. author refer to original template
             % and fill this in

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% The sections below are for reference only.
%%%
%%% For Original Research Articles, Clinical Trial Articles, and
%%% Technology Reports the section headings should be those
%%% appropriate for your field and the research itself. It is
%%% recommended to organize your manuscript in the following sections
%%% or their equivalents for your field:
%%%
%%% Abstract, Introduction, Material and Methods, Results, and Discussion.
%%%
%%% Please note that the Material and Methods section can be placed in
%%% any of the following ways: before Results, before Discussion or
%%% after Discussion.
%%%
%%% For information about Clinical Trial Registration, please go to
%%% http://www.frontiersin.org/about/AuthorGuidelines#ClinicalTrialRegistration
%%%
%%% For Clinical Case Studies the following sections are mandatory:
%%% Abstract, Introduction, Background, Discussion, and Concluding
%%% Remarks.
%%%
%%% For all other article types there are no mandatory sections.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
\section{}
To date, realistic models of how the central nervous system governs
behaviour have been restricted in scope to the brain, brainstem or
spinal column, as if these existed as disembodied organs.
Further, the model is often exercised in relation to an in vivo
physiological experiment with input comprising an impulse, a periodic
signal or constant activation, and output as a pattern of neural
activity in one or more neural populations. Any link to behaviour is
inferred only indirectly via these activity patterns.
%
We argue that to discover the principles of operation of neural
systems, it is necessary to express their behaviour in terms of
physical movements of a realistic motor system, and to supply inputs
that mimic sensory experience. To do this with confidence, we must
connect our brain models to neuro-muscular models and provide relevant
visual and proprioceptive feedback signals, thereby closing the loop
of the simulation.
%
This paper describes an effort to develop just such an integrated
brain and biomechanical system using a number of pre-existing
models. It describes a model of the saccadic oculomotor system
incorporating a neuromuscular model of the eye and its six extraocular
muscles. The position of the eye determines how illumination of a
retinotopic input population projects information about the location
of a saccade target into the system.
%
A pre-existing saccadic burst generator model was incorporated into
the system, which generated motoneuron activity patterns suitable for
driving the biomechanical eye. The model was demonstrated to make
accurate saccades to a target luminance under a set of environmental
constraints.
%
Challenges encountered in the development of this model showed the
importance of this integrated modelling approach. Thus, we exposed
shortcomings in individual model components which were only apparent
when these were supplied with the more plausible inputs available in a
closed loop design. Consequently we were able to suggest missing
functionality which the system would require to reproduce more
realistic behaviour.
%
The construction of such closed-loop animal models constitutes a new
paradigm of {\em computational neurobehaviour} and promises a more
thoroughgoing approach to our understanding of the brain's function as
a controller for movement and behaviour.

\tiny
 \keyFont{
   \section{Keywords:}
   integrated brain biomechanics neuromuscular oculomotor saccade basal ganglia
 } % 5 to 8 keywords
\end{abstract}

\section{Introduction}

% New introduction, tailored to the paradigm shift title.
(New Introduction:)

The field of computational neuroscience has provided
many \emph{systems models} of the brain~\cite{several_models}. We
refer to these as \emph{mechanistic computational models}, meaning
models which consist of populations of neural elements, interconnected
in a biologically plausible manner, which simulate the operation of
the brain.

Whilst they differ in scale and complexity, these models all seek to
describe the fundamental mechanisms behind common animal behaviours
such as locomotion, threat evasion, reaching or feeding. However,
almost none of the models cited here actually reproduce these
behaviours. In each case, the activity in a certain population of
neurons is taken to be representative of a behavioural outcome.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(Old introduction, which became the VPH mini-paper intro:)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Can make comparisons
As mechanistic computational models of brain systems become more
sophisticated we can aspire to make realistic comparisons between the
behaviour of the model and that of the animal or human.

% Short desc of mechanistic computational model
By \emph{mechanistic computational model}, we mean a model which
consists of populations of neural elements, interconnected in a
biologically plausible manner. Such a model may consist of neural
elements that produce a time-dependent membrane voltage and realistic
spiking behaviour (Hodgkin-Huxley, Fizhugh-Nagumo, Izhikevich, Leaky
integrate and fire) in which case the neural element's activity can be
obtained by counting action potentials (or considering their
timing). Alternatively it may (as it does in this work) consist of
rate-coded neural elements, whose activation variable is related to
the spiking rate of a number of neurons (refs).

% Sometimes, ok to just have a brain model
In some cases, it is sufficient to take the activity of an internal
population within the brain model as being representative of the
induced behaviour. For example, a choice made in a \e{go/no-go} task
could be determined from activity in a population within a Basal
Ganglia model
(\mycite{nambu_discharge_1990,kuhn_event-related_2004}). The decision
to \e{go} is selected by a reduction of activity in this population;
maintenance of activity implies \e{no-go}. Error rates in this task
could be compared with experimentally determined error rates in
primate subjects.
% Brain model comparison validates model
If the expression of behaviour by the model is similar when compared
with the experimental data, this serves to validate the model for the
healthy, neuro-typical subject.
% Now describe comparison between model and expt. for diseased
% subject.
If we have confidence in the model's description of the behaviour for
the healthy subject, we can now progress to a comparison between the
model and an unhealthy subject. If we can identify a characteristic
degradation in an aspect of the brain for an unhealthy subject, then
we can seek to modify the model to mirror this degradation. By
comparing the relationship between the model's behaviour as a function
of the degradation parameter with the unhealthy individual's behaviour
as a function of disease progression, we may be able to relate the
disease progression state to the brain parameter and predict the
time-course of the internal degradation of the brain.
% Leave further discussion along these lines to the discussion
% section.

% But sometimes you might need brain and neuromuscular model
Many behaviours are more complex and subtle than a decision. In the
disease state, it may be the dynamics of the movement which is
symptomatic rather than its outcome. A diagnostic task may produce an
outcome whose error rate varies with disease state, but it may also
produce movement characteristics which correlate with the disease
progression such as the slow, jerky or inaccurate movements seen in
Parkinson's Disease. In order to determine the validity of a model
which seeks to describe more complex movements, it is necessary to
express the movement commanded by the brain network as a realistic,
simulated motion by means of a biomechanical model, driven by the
brain model.

% Motivation here is to study movement disorders by means of a
% comparison between healthy subjects, the healthy model and diseased
% subjects and the diseased model.
Our motivation is to study movement disorders using our brain
models. Because the challenge of integrating brain and biomechanical
models has not, to our knowledge, previously been addressed, we chose
to express some of the simplest, and most studied movements made by
vertebrates: the rapid eye movements known as saccades. Saccades
direct the fovea, the region of the eye with the highest spatial
imaging resolution, towards putative targets of interest. Mammals make
frequent saccades; many thousands every day. These movements are often
described as ballistic: They are commanded by activity in the superior
colliculus which encodes an endpoint for the saccade trajectory
(\mycite{wurtz_superior_1971,hepp_monkey_1993}); once initiated, the
saccade proceeds in a relatively direct and stereotyped (though not
always straight) trajectory (\mycite{van_der_stigchel_eye_2006}) to
the endpoint.
% Why am I mentioning curved saccades? Because it shows that saccades
% can exhibit rich behaviour and that modelling them is worthwhile.
However, numerous studies have shown that saccade trajectories are
affected by distractors (\mycite{mcpeek_competition_2003,
port_sequential_2003, van_der_stigchel_recent_2010}) and may be
modified in-flight to the extent that saccades may be seen to perform
significant, sometimes even U-shaped, curves towards or away from
distractors. This shows that whilst saccades are simple compared to
the movements of limbs, they still provide information about a number
of mechanisms within the brain and an effort to model them accurately
is worthwhile.

% Say what we've done here, in short form.
Parkinson's Disease is a progressive neurological disorder whose main
symptoms relate to motor control. These include resting tremor,
slowness of movements (bradykinesia), difficulty in initiating
movement (akinesia) and rigidity (refs). It is considered to be a
disease of the basal ganglia because during its progression, dopamine
producing neurons in the substantia nigra pars compacta die away
(ref), affecting the the striatum which depends on endogenous dopamine
for correct operation (ref). The basal ganglia plays an important role
in decision making and action selection (ref), including the selection
of saccadic eye movements (\mycite{hikosaka_role_2000}). In the later
stages of Parkinson's Disease, patients show more latent saccades to
targets of interest (ref). They have also been documented as showing
poorer performance in the so-called anti-saccade protocol, in which
the subject is instructed to make a saccade \e{away} from a visual
target. Parkinson's Disease patients make significantly more errors;
they will saccade \e{to} the visual target rather than \e{away} from
it more often than healthy control subjects. To investigate the way in
which degradation in the basal ganglia may be causing these defects we
have developed an integrated brain and biomechanical eye model which
we describe here. The model will initially be used to investigate the
deterioration in anti-saccadic movements which is detectable even in
relatively early-stage Parkinson's Disease.

%See \mycite{Rottach_dynamic_1996} for trajectory information in saccades.

%% End of intro here? Or carry on with a description of the physiology
%% of saccadic eye movements?

Many neural populations are involved in the coding of saccadic eye
movements, only a very brief overview is given here; for a recent
review, see \mycite{munoz_commentary:_2002}. One pathway takes
information from the retina directly into the superficial layers of
the superior colliculus in the brainstem (\mycite{?}). Activity within
the superior colliculus then excites neurons in the pons, medulla and
rostral midbrain (\mycite{sparks_brainstem_2002}) and then through
channels to the motor neurons which innervate the extraocular muscles
(\mycite{fuchs_firing_1970,sparks_brainstem_2002}). This direct pathway
is responsible for the low latency saccades called express saccades
(\mycite{?}).

% FEF: \mycite{schall_neural_1999}
Information from the retina is also processed by visual cortex which
feeds through to the frontal eye fields in which activity is related
to reflexive and voluntary
saccades \mycite{schall_neural_1999}. Activity build up in the frontal
eye fields is transferred to the intermediate layers of the superior
colliculus
\mycite{?} and is also processed by the basal ganglia, which
participates in the selection of the winning saccade end point
\mycite{?}.

% On fact that SC doesn't encode oblique/torsional movements:
% \cite{hepp_monkey_1993}

% That means that you need both the expression of movement, and also a
% means by which you can progress the disease in the model.

%If such comparisons are to be made, then the behavioural output of the
%model should be in the form of movements which can be directly
%compared with the biological system. In order to express movements,
%the brain model needs to drive biomechanical neuromuscular models.


%\begin{methods}
\section{Material \& Methods}

% A very short introduction to the section.
The integrated brain and biomechanical model described here is a
development of the model in \mycite{alex_cope_integrative_2015},
referred to here as the \ccg~model. This was a rate-coded neural
network model incorporating retinal populations, frontal eye fields
(FEF), the basal ganglia (BG), and the superior colliculus (SC). In
the \ccg~model, the ``centre of mass'' of the activity in the deep
layers of superior colliculus was assumed to accurately encode the
location of the eye at the end of the saccade~\cite{someone}. This
location was used to recalculate the positions of the luminances in
the eye's frame of reference at each time step. The model included no
brainstem populations other than superior colliculus, nor a
neuromuscular model.

To the \ccg~model, we have added a brainstem model (a ``saccadic burst
generator''), and a biomechanical eye. These will be described below,
but first we will give an explanation of the modelling framework used.

% Section - description of how the model fits together - which
% components it's made from.
\subsection{Model development framework}

% Say the \ccg~model was implemented in matlab-brahms & this one is SpineML.
The \ccg~model was originally developed to run on the BRAHMS model
execution framework
(\mycite{mitchinson_brahms:_2010,mitchinson_brahms_2015}). To run a
BRAHMS model, the researcher must develop \e{BRAHMS components} for
the various neural elements. A BRAHMS component is a programmatically
coded implementation of the behaviour of the component. It may have an
arbitrary number of inputs and outputs and may be written in C, C++,
Python or MATLAB. The \ccg~model's components were hand written in C++
and MATLAB. A BRAHMS \e{SystemML} file describes how the different
components connect together and how data is passed between them
(\mycite{mitchinson_brahms:_2010}). The main BRAHMS program first
reads the SystemML file, then dynamically loads all the required
components before executing the system.

In the current work, the \ccg~model was reproduced using the
declarative SpineML markup language (\mycite{richmond_model_2014}),
with the help of the graphical SpineML model editing software
called SpineCreator
(\mycite{cope_spinecreator:_2016}). SpineML,
which is a development of the NineML specification
(\mycite{incf_task_force_on_multi-scale_modeling_network_2011}),
describes neural populations and their projections in a highly
structured format in which neuron bodies, pre- and post-synapses are
described in terms of \e{SpineML components}. These are similar to the
components provided by BRAHMS, but in this case, the components are an
XML description of the functionality of the component, rather than a
programmatic implementation, with one XML file per component. A
SpineML \e{network layer} file then describes which components are
used in the model, and how they are connected together. Finally, a
number of SpineML \e{experiment layer} files describe how the model
described in the network layer can be executed. In the experiment
layer, the execution duration and timestep can be specified, along
with input conditions, connection lesions and component parameter
updates. A complete description of SpineML is given
in \mycite{richmond_model_2014}.

SpineCreator, in its r\^ole as a graphical editor for the SpineML
format, was used to generate the SpineML files describing the
model. It was also used to generate the diagrams of the model
(e.g. Fig.~\ref{brain_model}).

As a declarative format for model specification, SpineML is agnostic
about how the model is executed. A number of SpineML simulation
engines exist, including DAMSON (\mycite{richmond_damson_2015}), GeNN
(\mycite{nowotny_flexible_2011,nowotny_spineml_2014}) and BRAHMS (used
here). The simulation engine for BRAHMS is called \stob~
(\mycite{cope_spineml_2_brahms_2015-1}). \stob~is a collection of XSLT
stylesheets which first generate and compile C++ BRAHMS components
from the SpineML component layer description files. \stob~then uses
the SpineML network and experiment layer files to generate a BRAHMS
SystemML description of the model. Finally, \stob~executes the model,
now described entirely as a BRAHMS system, via a call to the BRAHMS
binary. A number of additional hand-written components are present
in \stob~providing the inputs (constant inputs, time-varying inputs,
etc) which the modeller specifies in the experiment layer.

In addition to the brain model components, all of which are
code-generated using \stob~as described above, three hand-written
components are integrated into the model: The biomechanical eye model;
a component which computes the centroid of a neural layer; and a
component which takes as inputs the eye's rotational state and the
state of the experimental luminances and projects a retinotopic
activity map into the brain model. Each of these three BRAHMS
components was hand written in C++. To incorporate these components
into the present integrated model, a model-specific modification was
made to the scripts in \stob~(\mycite{cope_spineml_2_brahms_2015}).

Figure \ref{model_framework} shows the workflow, in which the model
specification files (blue box), a combination of SpineML files and C++
code, are processed (green box) into a BRAHMS system (red box).

\subsection{Existing brain model}

The brain model, excluding the brainstem, is a re-implementation of
the \ccg~model. Figure \ref{brain_model} shows the layout of the
populations and the interconnections between them. Each population of
2500 elements is arranged as a 50 by 50 grid which forms a map in a
retinotopic co-ordinate system, roughly matching the known layout of
the superior colliculus (SC). % FIXME: and frontal eye field?

\subsubsection{Components}

(\mycite{robinson_eye_1972}). With the exceptions of the World and
FEF\_add\_noise populations, each neural element represents an
activation whose dynamics depend on the component definition. In the
brain model, there are six different components in use; LINlinear,
LINlinearNoisy, LINret, LINexp, D1MSN and D2MSN.

The LINlinear component governs the activation $a$ with a first order
leaky integrator differential equation:
\[
   \dot{a} = {1 \over \tau}(a_{in}-a)
\]
where $\tau$ is the time constant for the neural activation and
$a_{in}$ is the input to the neural element. $a_{in}$ is defined by an
activation input and a shunting inhibition input according to:
\[
   a_{in} = A(1-s_a)+0.01 R_N
\]
Here, $A$ is the activation input and $s_a$ is the shunting inhibition
state variable whose value is related to the shunting input, $S$ by
\[
   s_a = \begin{cases}
      S & S\leq 1 \\
      1 & S > 1
   \end{cases}
\]
$R_N$ is a random number between 0 and 1 drawn from a
normal distribution and introduces noise to the activation of the
neural element.

The output, $y$, of LINlinear is related to the activation by the
piecewise linear transfer function
\[
   y(a) = \begin{cases}
      0   & a < c \\
      a-c & c \leq a \leq 1+c \\
      1   & a > 1+c
   \end{cases}
\]
where $c$ is a parameter defining the slope of the transfer
function. At this point, the naming scheme for the component becomes
apparent; this is a Leaky Integrator with a linear transfer function.

LINlinearNoisy is identical to LINlinear with the single exception
that the level of noise is increased. This means that the equation for
$a_{in}$ must be rewritten:
\[
   a_{in} = A(1-s_a)+0.2 R_N
\]
The LINret component used for the retinal populations is again similar
to the LINlinear component, but with no intrinsic noise and no
shunting inhibitory input. It has a neural input which is identical to
the activation input $A$:
\[
   a_{in} = A
\]
The LINexp component is a leaky integrator with an exponential
transfer function. It shares the same differential equation with
LINlinear, but has a different input equation and a different output
transfer function. It has the following equation for the neural
element input $a_{in}$:
\[
   a_{in} = [A+N(a-V_{r}^{-})] (1-S) + 0.01 R_N
\]
where $A$ is the activation input and $N$ is an input which is
modulated by $V_{r}^{-}$, a reversal potential, and $a$, the current
activation of the element. These inputs are summed and then reduced by
a factor which is dependent on $S$, the shunting input. As in
LINlinear, $R_N$ introduces normally distributed noise to the element.

The output, $y$, of the LINexp component is given by
\[
   y(a) = \begin{cases}
      \mathrm{e}^{a}-0.9   & \mathrm{e}^a \leq 1+0.9 \\
      1   & \mathrm{e}^a > 1+0.9
   \end{cases}
\]
This component is used in the STN population, as it gives a more
physiologically accurate f-I
behaviour \mycite{wilson_model_2004,bevan_mechanisms_1999,hallworth_apamin-sensitive_2003}
which has been shown to allow the mapping of the basal ganglia network
architecture onto an optimal decision making
model \mycite{bogacz_basal_2007}.

%
% That's the components described. Next up is to have a figure of the
% activity for representative input to the model.
%

\subsubsection{Population activity}

Each population of 2500 neural elements is arranged in a 50 by 50
grid, with positions on the grid representing a retinotopic
mapping. Locations on the grid specify radial and azimuthal angles r
and $\phi$ for the location of activity on the retina relative to the
fovea. r and $\phi$ can be converted into rotations about the $x$ and
$y$ Cartesian axes ($\theta_x$ and $\theta_y$). The result of a
positive rotation about the $x$ axis in a right-handed Cartesian
coordinate system results in an "upward movement" of the fovea's view
of the environment. Note that a positive rotation about the $y$ axis
results in a "leftward movement".

The magnification factor, $M_f$, gives the relationship between the
radial angle r and the retinal neural density. It is given by:
\[
   M_f = {W_{nfs} \over E_2 ln ({W_{fov} \over 2 E_2} + 1)}
\]
where $W_{nfs}$ is the width of the retinotopic neural fields (50),
$W_{fov}$ is the eye's field of view, which is set to 61 degrees, a
reduction from the biophysically accurate 150 degrees due to the small
number of neurons in the retinotopic neural field. $E_2$ is the
eccentricity (in degrees) at which the retinal neural density has
halved compared with the foveal region.

With $M_f$ calculated, the mapping from the retinotopic radial and
angular components, $r$ and $\phi$ to $\theta_x$ and $\theta_y$ is:
\[
   \theta_x = E_2 (e^{{r \over M_f E_2}} - 1).\cos({2 \pi \phi \over
   W_{nfs}}) \tag{1}
\]
\[
   \theta_y = E_2 (e^{{r \over M_f E_2}} - 1).\sin({2 \pi \phi \over W_{nfs}}) \tag{2}
\]

It is straightforward to show that the reverse mapping is given by:
\[
   \phi = {W_{nfs} \over 2 \pi}\arctan({\theta_y\over\theta_x}) \tag{3}
\]
\[
   r = M_f E_2 \ln ({1\over E_2}\sqrt{{\theta_x}^2 + {\theta_y}^2}+1) \tag{4}
\]

Figure \ref{mapping} shows the result of the mapping for a view of two
cross-shaped luminances. One cross illuminates the fovea, which
results in a large comb-shape of activity. The more peripheral cross
produces an indistinct object centered at a larger value of r.

It is important to note that in practice there are edge effects within
the model which prevent this theoretical mapping from holding
perfectly. The most significant of these is the result of the diffuse
excitation from STN to GPe... etc % FIXME Where are the edge effects
                                  % most prevalent? In BG I think

\subsubsection{Network}

Briefly, the model consists of input from the World population
producing activity in an ``express'' pathway to superior colliculus
and simultaneously in cortex, represented here by the FEF
population. The express pathway causes short latency activity in the
superficial superior colliculus, which directly innervates the deeper
layers of the superior colliculus (SC\_deep). Activity in FEF
generates firing in a thalamo-cortico-basal ganglia loop. The output
of the basal ganglia is the substantia nigra pars reticulata (SNr)
which tonically inhibits SC\_deep. If a location of activity in FEF is
able to dominate selection in the basal ganglia circuit, the
corresponding location in SNr will dis-inhibit and activity will build
up in SC\_deep encoding the saccade end point.

Connections shown in red are one to one connections; dark blue
connections indicate a connectivity pattern which ``fans out'' with a 2-D
Gaussian kernel; lighter blue connections from STN to SNr and GPe are
diffuse, all to all connections and connections in green are one to one
connections that decay towards the fovea so that foveal activity in
FEF does not swamp the basal ganglia which would prevent peripheral
luminances from being selected.

Note that SC\_deep contains two recurrent connections; one is
excitatory, with a Gaussian kernel mapping and the other implements
tecto-tectal inhibition, which increases the inhibition between
activity in opposite hemispheres of the field of view (refs). The
tecto-tectal inhibitory connection is \em{not} present in the \ccg
model.

%However, it does not describe deeper, motor regions of the
%brainstem, instead regarding the centroid of the activity in SC as
%being representative of the end point of the saccade
%trajectory \mycite{mays_dissociation_1980,lee_population_1988,van_Opstal_role_1990}.

% Section - description of new brainstem model
\subsection{brainstem model}

Neurons in the deep layers of the superior colliculus called long lead
burst neurons innervate excitatory burst neurons in the reticular
formation (ref). In this model, we implement a network based
on \mycite{gancarz_neural_1998}.

% Section - description of biomechanical model
\subsection{biomechanical eye}

Patras work here.

% Section - description of the integration
\subsection{Integrating the models}

%\end{methods}


\section{Results}

% trajectories, neuron activations (esp. brainstem). latency vs
% dopamine, latency vs gap.

\section{Discussion}

% Be sure to say that ``in future work, it will be possible to
% investigate saccade trajectory modifications in Parkinson's''

\subsection{Subsections}

% Frontiers requires figures to be submitted individually, in the same
% order as they are referred to in the manuscript. Figures will then
% be automatically embedded at the bottom of the submitted
% manuscript. Kindly ensure that each table and figure is mentioned in
% the text and in numerical order. Permission must be obtained for use
% of copyrighted material from other sources (including the
% web). Please note that it is compulsory to follow figure
% instructions. Figures which are not according to the guidelines will
% cause substantial delay during the production process.

% To take part in the Resource Identification Initiative, please cite
% antibodies, genetically modified organisms, software tools, data,
% databases and services using the corresponding catalog number and
% RRID in your current manuscript. For more information about the
% project and for steps on how to search for an RRID, please click
% \href{http://www.frontiersin.org/files/pdf/letter_to_author.pdf}.

% Equations:
%\begin{equation}
%\sum x+ y =Z\label{eq:01}
%\end{equation}

\section*{Disclosure/Conflict-of-Interest Statement}

The authors declare that the research was conducted in the absence of
any commercial or financial relationships that could be construed as a
potential conflict of interest.

\section*{Author Contributions}
%When determining authorship the following criteria should be observed:
%•	Substantial contributions to the conception or design of the work; or the acquisition, analysis, or interpretation of data for the work; AND
%•	Drafting the work or revising it critically for important intellectual content; AND
%•	Final approval of the version to be published ; AND
%•	Agreement to be accountable for all aspects of the work in ensuring that questions related to the accuracy or integrity of any part of the work are appropriately investigated and resolved.
%Contributors who meet fewer than all 4 of the above criteria for authorship should not be listed as authors, but they should be acknowledged. (http://www.icmje.org/roles_a.html)

SJ, AB and AC implemented existing parts of the model in SpineML. AB
developed the saccade generator brainstem model. SJ performed the
technical integration of the biomechanical eye. DS, CP and KM
developed the biomechanical eye model. SJ wrote the manuscript. KG
conceived the experiment. % FIXME: This needs correcting/developing.

\section*{Acknowledgments}

\textit{Funding\textcolon} European Union FP7 Grant 610391 ``NoTremor''.

\section*{Supplemental Data}

Models available on github - include details of branches, commits etc
for running the model.

\selectlanguage{English}
\bibliographystyle{frontiersinSCNS_ENG_HUMS}
% The bibliography NoTremor.bib is the one exported from Zotero.
\bibliography{NoTremor}

%%% Upload the *bib file along with the *tex file and PDF on
%%% submission if the bibliography is not in the main *tex file




\section*{Figures}

%%% Use this if adding the figures directly in the mansucript, if so,
%%% please remember to also upload the files when submitting your
%%% article There is no need for adding the file termination, as long
%%% as you indicate where the file is saved. In the examples below the
%%% files (logo1.jpg and logo2.eps) are in the Frontiers LaTeX folder
%%% If using *.tif files convert them to .jpg or .png

%\begin{figure}[h!]
%\begin{center}
%\includegraphics[width=10cm]{logo1.jpg}% This is a *.jpg file
%\end{center}
% \textbf{\refstepcounter{figure}\label{fig:01} Figure \arabic{figure}.}{ Enter the caption for your figure here.  Repeat as  necessary for each of your figures }
%\end{figure}

%\begin{figure}
%\begin{center}
%\includegraphics[width=10cm]{logo2}% This is an *.eps file
%\end{center}
%\textbf{\refstepcounter{figure}\label{fig:02} Figure \arabic{figure}.}{ Enter the caption for your figure here.  Repeat as  necessary for each of your figures }
%\end{figure}

%%% If you don't add the figures in the LaTeX files, please upload
%%% them when submitting the article.

%%% Frontiers will add the figures at the end of the provisional pdf
%%% automatically

%%% The use of LaTeX coding to draw Diagrams/Figures/Structures should
%%% be avoided. They should be external callouts including graphics.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{./figures/intro_graphic.png}
\end{center}
\textbf{\refstepcounter{figure}\label{intro_graphic} Figure \arabic{figure}.}
{ An isolated brain model. Crafted inputs are introduced into one of
the model's n state variables. The output of another of the state
variables implies behavioural change or onset.}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.9\textwidth]{./figures/model_framework.png}
\end{center}
\textbf{\refstepcounter{figure}\label{model_framework} Figure \arabic{figure}.}
{ The model framework. The model is specified using a combination of
declarative XML files and hand-coded C++. These original model
specifications are shown within the blue box. b) The green box shows
the processes which are applied to the model specification to produce
the BRAHMS system. Most of the process is defined within the scripts
which make up \stob, but the three hand-written components must be
manually compiled and installed within the BRAHMS Namespace, allowing
the BRAHMS executable to locate them at runtime. c) The red box shows
the resulting BRAHMS system ready to be executed by the BRAHMS
executable. In practice, this call is made by \stob.}
\end{figure}

\begin{figure}[htb!]
\begin{center}
\includegraphics[width=0.9\textwidth]{./figures/mapping.png}
\end{center}
\textbf{\refstepcounter{figure}\label{mapping} Figure \arabic{figure}.}
{ Representative mapping from eye's frame of reference in cartesian
coordinates to retinotopic coordinates. (a) The mapping of luminances
in the eye's frame of reference. The world input is pre-defined by a
JSON configuration file. luminance position, size and shape can be
defined in this file, along with the times at which luminances appear
and disappear. The worldDataMaker.cpp code computes the locations of
the luminances in the eye's frame of reference, given its rotational
state. Here, there are two cross shaped luminances, one at the
fixation point (0,0) and one at a peripheral position (4,-10). (b) The
locations of the luminances in the eye's frame of reference are then
converted into retinotopic coordinates, with centrally located
luminances being represented at low values of $r$ and more peripheral
luminances having higher values of $r$. $phi$ encodes rotational
angle: 12.5 is up, [etc etc]. The output of the World component is fed
into FEF\_add\_noise and into the retinal neuron populations. (c) The
FEF\_add\_noise populations adds a level of noise to the signal
representing processing of the signal in visual cortex. (d) The
activity in FEF is the input to the basal ganglia and one input to
superior collicus.}
\end{figure}

\begin{figure}[htb!]
\begin{center}
\includegraphics[width=0.9\textwidth]{./figures/Brain_Model.png}
\end{center}
\textbf{\refstepcounter{figure}\label{brain_model} Figure \arabic{figure}.}
{ This is the Brain Model}
\end{figure}

\end{document}
