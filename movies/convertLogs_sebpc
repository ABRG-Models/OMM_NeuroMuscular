#!/usr/bin/octave
% Open a file, shape the data to 0-255 per pixel so that it's ready
% for movie making.

% Expects 50x50 format data, as generated by the Oculomotor model.

logDir = '/home/seb/src/SpineML_2_BRAHMS/temp/log/';

populations = {'Retina_1', 'Retina_2', 'FEF', 'SC_deep', 'GPe', 'SC_avg', 'SNr', 'STN', 'Str_D1', 'Str_D2', 'Thalamus', 'FEF_add_noise', 'World'};

rmcmd = char(['rm -rf ' logDir '/montage/*']);
%system (rmcmd);

for pop = 1 : length(populations)

    rmcmd = char(['rm -rf ' logDir char(populations(pop)) '/*']);
    %   system (rmcmd);
  
    [data, count] = load_sc_data (char([logDir char(populations(pop)) '_out_log.bin']), ...
                          2500);
    % Scale and convert to uint8
    fprintf ('Loaded %d from %s\n', count, char([logDir char(populations(pop)) '_out_log.bin']));
    data = uint8(data.*255);

    % Save
    fid = fopen (char([logDir char(populations(pop)) '_out_uint8.bin']), 'w')
    fwrite (fid, data, 'uint8');
end
